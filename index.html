<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="description" content="Join Jaycee and Emily for their Myrtle Beach wedding celebration. Interactive features, games, photos and more!">
    <meta name="theme-color" media="(prefers-color-scheme: light)" content="#047857">
    <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1c1917">
    <title>Jaycee & Emily's Dream Wedding 💕</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>tailwind.config = { darkMode: 'class' }</script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&family=Playfair+Display:wght@400;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #047857;
            --primary-light: #10b981;
            --accent: #ec4899;
            --gold: #f59e0b;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #FEFBF6 0%, #FFF5E6 100%);
            color: #2b2726;
            overflow-x: hidden;
        }
        
        body.dark-mode {
            background: linear-gradient(135deg, #1c1917 0%, #292524 100%);
            color: #d6d3d1;
        }
        
        h1, h2, h3, .font-display {
            font-family: 'Playfair Display', serif;
        }
        
        .font-script {
            font-family: 'Dancing Script', cursive;
        }
        
        /* Animations */
        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(5deg); }
        }
        
        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 20px rgba(236, 72, 153, 0.5); }
            50% { box-shadow: 0 0 40px rgba(236, 72, 153, 0.8); }
        }
        
        @keyframes shimmer {
            0% { background-position: -1000px 0; }
            100% { background-position: 1000px 0; }
        }
        
        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            10%, 30% { transform: scale(1.1); }
            20% { transform: scale(1.05); }
        }
        
        @keyframes confetti-fall {
            to {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }
        
        @keyframes slide-up {
            from { transform: translateY(100px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        @keyframes fade-in-scale {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        .animate-float {
            animation: float 6s ease-in-out infinite;
        }
        
        .animate-heartbeat {
            animation: heartbeat 1.5s ease-in-out infinite;
        }
        
        .shimmer {
            background: linear-gradient(90deg, transparent 0%, rgba(255,255,255,0.3) 50%, transparent 100%);
            background-size: 1000px 100%;
            animation: shimmer 2s infinite;
        }
        
        .glass-morphism {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .dark-mode .glass-morphism {
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        /* Page transitions */
        .page {
            display: none;
            animation: slide-up 0.5s ease-out;
        }
        
        .page.active {
            display: block;
        }
        
        /* Enhanced nav */
        .nav-icon {
            position: relative;
            transition: all 0.3s ease;
        }
        
        .nav-icon::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 50%;
            width: 0;
            height: 2px;
            background: var(--primary);
            transition: all 0.3s ease;
            transform: translateX(-50%);
        }
        
        .nav-icon.active::after {
            width: 30px;
        }
        
        .nav-icon.active {
            color: var(--primary);
            transform: translateY(-2px);
        }
        
        /* Countdown styles */
        .countdown-digit {
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            position: relative;
            overflow: hidden;
            animation: fade-in-scale 0.5s ease-out;
        }
        
        .countdown-digit::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.2) 50%, transparent 70%);
            transform: rotate(45deg);
            animation: shimmer 3s infinite;
        }
        
        /* Love meter enhanced */
        .love-meter {
            background: linear-gradient(90deg, #ec4899 0%, #f97316 33%, #eab308 66%, #10b981 100%);
            height: 30px;
            border-radius: 15px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(236, 72, 153, 0.3);
        }
        
        .love-meter-fill {
            position: absolute;
            height: 100%;
            background: rgba(255, 255, 255, 0.3);
            animation: pulse 2s ease-in-out infinite;
        }
        
        .love-meter::after {
            content: '💕';
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 20px;
            animation: heartbeat 1.5s ease-in-out infinite;
        }
        
        /* Card styles */
        .wedding-card {
            background: white;
            border-radius: 1rem;
            padding: 1.5rem;
            box-shadow: 0 10px 30px -10px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .wedding-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--primary) 0%, var(--accent) 100%);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }
        
        .wedding-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.15);
        }
        
        .wedding-card:hover::before {
            transform: scaleX(1);
        }
        
        .dark-mode .wedding-card {
            background: rgba(31, 41, 55, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        /* Game card enhanced */
        .game-card {
            cursor: pointer;
            background: linear-gradient(135deg, #ffffff 0%, #f0fdf4 100%);
            position: relative;
            overflow: hidden;
        }
        
        .game-card::after {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(16, 185, 129, 0.1) 0%, transparent 70%);
            transform: scale(0);
            transition: transform 0.5s ease;
        }
        
        .game-card:hover::after {
            transform: scale(3);
        }
        
        .dark-mode .game-card {
            background: linear-gradient(135deg, rgba(31, 41, 55, 0.9) 0%, rgba(16, 185, 129, 0.1) 100%);
        }
        
        /* Button styles */
        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            font-weight: 600;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .btn-primary::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        .btn-primary:hover::before {
            width: 300px;
            height: 300px;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px -5px rgba(4, 120, 87, 0.3);
        }
        
        /* Gemini button enhanced */
        .gemini-button {
            background: linear-gradient(135deg, #e879f9 0%, #f0abfc 100%);
            color: #701a75;
            border: 1px solid #e879f9;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .gemini-button span:first-child {
            display: inline-block;
            animation: float 2s ease-in-out infinite;
        }
        
        .gemini-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px -5px rgba(232, 121, 249, 0.3);
        }
        
        /* Modal enhancements */
        .modal-backdrop {
            backdrop-filter: blur(5px);
            transition: all 0.3s ease;
        }
        
        .modal-content {
            animation: fade-in-scale 0.3s ease-out;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        /* Photo grid enhanced */
        .photo-item {
            position: relative;
            overflow: hidden;
            border-radius: 0.75rem;
            cursor: pointer;
            aspect-ratio: 1;
        }
        
        .photo-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }
        
        .photo-item:hover img {
            transform: scale(1.1);
        }
        
        .photo-item .photo-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.7) 0%, transparent 100%);
            color: white;
            padding: 1rem;
            transform: translateY(100%);
            transition: transform 0.3s ease;
        }
        
        .photo-item:hover .photo-overlay {
            transform: translateY(0);
        }
        
        /* Achievement badge */
        .achievement-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: linear-gradient(135deg, var(--gold) 0%, #fbbf24 100%);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 600;
            box-shadow: 0 4px 10px -2px rgba(245, 158, 11, 0.3);
            animation: fade-in-scale 0.5s ease-out;
        }
        
        /* Loading spinner */
        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(0, 0, 0, 0.1);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Confetti */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: var(--accent);
            animation: confetti-fall 3s linear;
            z-index: 100;
        }
        
        /* Toast notification */
        .toast {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 1rem 2rem;
            border-radius: 0.5rem;
            font-weight: 500;
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 100;
        }
        
        .toast.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }
        
        /* Love story timeline */
        .timeline-item {
            position: relative;
            padding-left: 3rem;
            padding-bottom: 2rem;
            border-left: 2px solid var(--primary);
        }
        
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -8px;
            top: 0;
            width: 16px;
            height: 16px;
            background: var(--primary);
            border-radius: 50%;
            box-shadow: 0 0 0 4px rgba(4, 120, 87, 0.2);
        }
        
        .timeline-item:hover::before {
            animation: pulse 1s ease-in-out infinite;
        }
        
        /* Weather widget */
        .weather-widget {
            background: linear-gradient(135deg, #3b82f6 0%, #60a5fa 100%);
            color: white;
            padding: 1rem;
            border-radius: 1rem;
            position: relative;
            overflow: hidden;
        }
        
        .weather-widget::before {
            content: '☀️';
            position: absolute;
            top: -20px;
            right: -20px;
            font-size: 80px;
            opacity: 0.2;
            animation: float 10s ease-in-out infinite;
        }
        
        /* RSVP form styles */
        .rsvp-input {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 2px solid #e5e7eb;
            border-radius: 0.5rem;
            transition: all 0.3s ease;
            font-size: 1rem;
        }
        
        .rsvp-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(4, 120, 87, 0.1);
        }
        
        /* Music vote item */
        .music-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.02);
            border-radius: 0.5rem;
            transition: all 0.3s ease;
        }
        
        .music-item:hover {
            background: rgba(0, 0, 0, 0.05);
            transform: translateX(5px);
        }
        
        .vote-bar {
            height: 4px;
            background: #e5e7eb;
            border-radius: 2px;
            overflow: hidden;
            margin-top: 0.5rem;
        }
        
        .vote-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary) 0%, var(--accent) 100%);
            transition: width 0.5s ease;
        }
        
        /* Photo booth filters */
        .filter-option {
            width: 80px;
            height: 80px;
            border-radius: 0.5rem;
            overflow: hidden;
            cursor: pointer;
            border: 3px solid transparent;
            transition: all 0.3s ease;
        }
        
        .filter-option.active {
            border-color: var(--primary);
            transform: scale(1.1);
        }
        
        /* Mobile optimizations */
        @media (max-width: 768px) {
            .modal-content {
                margin: 1rem;
                max-height: calc(100vh - 2rem);
            }
            
            .countdown-digit {
                font-size: 1.5rem;
                min-width: 60px;
            }
            
            .nav-icon span {
                font-size: 0.625rem;
            }
        }
        
        /* Loading state */
        .skeleton {
            background: linear-gradient(90deg, #f3f4f6 25%, #e5e7eb 50%, #f3f4f6 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }
        
        /* Haptic feedback (mobile) */
        .haptic {
            -webkit-tap-highlight-color: rgba(4, 120, 87, 0.2);
        }
        
        /* Print styles */
        @media print {
            .no-print {
                display: none !important;
            }
        }
    </style>
</head>
<body class="bg-[#FEFBF6] text-stone-800 dark:bg-stone-900 dark:text-stone-200 antialiased">
    
    <!-- Confetti Container -->
    <div id="confetti-container" class="fixed inset-0 pointer-events-none z-50"></div>
    
    <!-- Toast Container -->
    <div id="toast" class="toast"></div>

    <div id="app-container" class="hidden">
        <!-- Enhanced Header -->
        <header class="glass-morphism sticky top-0 z-20 shadow-sm border-b border-stone-200/50 dark:border-stone-700/50 no-print">
            <div class="container mx-auto px-4 py-3">
                <div class="flex justify-between items-center">
                    <div class="flex items-center space-x-3">
                        <div class="animate-heartbeat text-2xl">💕</div>
                        <h1 class="text-xl font-bold bg-gradient-to-r from-emerald-600 to-pink-600 bg-clip-text text-transparent">
                            J&E Wedding Hub
                        </h1>
                    </div>
                    <div class="flex items-center space-x-4">
                        <div id="user-info" class="text-right">
                            <p id="user-display-name" class="font-semibold text-stone-700 dark:text-stone-300"></p>
                            <div class="flex items-center justify-end space-x-2 text-xs">
                                <span id="user-points" class="achievement-badge hidden">
                                    <i class="fas fa-star"></i>
                                    <span>0 pts</span>
                                </span>
                                <span class="text-stone-500 dark:text-stone-400">
                                    Guest #<span id="user-id-display"></span>
                                </span>
                            </div>
                        </div>
                        <button id="dark-mode-toggle" class="text-xl p-2 rounded-lg hover:bg-stone-100 dark:hover:bg-stone-800 transition" aria-label="Toggle dark mode">
                            <i class="fas fa-moon dark:hidden"></i>
                            <i class="fas fa-sun hidden dark:inline"></i>
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <main id="main-content" class="container mx-auto px-4 py-6 pb-32">
            <!-- Home Page Enhanced -->
            <div id="page-home" class="page">
                <!-- Countdown Section -->
                <div class="wedding-card mb-6">
                    <h2 class="text-3xl font-bold text-center mb-6 font-script">
                        The Adventure Begins In...
                    </h2>
                    <div id="countdown" class="flex justify-center gap-3 mb-6">
                        <div class="text-center">
                            <div class="countdown-digit" id="days">00</div>
                            <p class="text-sm mt-2 text-stone-600 dark:text-stone-400">Days</p>
                        </div>
                        <div class="text-center">
                            <div class="countdown-digit" id="hours">00</div>
                            <p class="text-sm mt-2 text-stone-600 dark:text-stone-400">Hours</p>
                        </div>
                        <div class="text-center">
                            <div class="countdown-digit" id="minutes">00</div>
                            <p class="text-sm mt-2 text-stone-600 dark:text-stone-400">Minutes</p>
                        </div>
                        <div class="text-center">
                            <div class="countdown-digit" id="seconds">00</div>
                            <p class="text-sm mt-2 text-stone-600 dark:text-stone-400">Seconds</p>
                        </div>
                    </div>
                    <div class="love-meter rounded-full overflow-hidden">
                        <div class="love-meter-fill" style="width: 100%"></div>
                    </div>
                    <p class="text-center text-sm text-stone-600 dark:text-stone-400 mt-3">
                        Love meter: <span class="font-bold text-pink-600">OVERFLOWING!</span> 💕
                    </p>
                </div>

                <!-- Weather Widget -->
                <div class="weather-widget mb-6">
                    <div class="relative z-10">
                        <h3 class="font-bold text-lg mb-2">Wedding Day Weather</h3>
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-3xl font-bold">78°F</p>
                                <p class="text-sm opacity-90">Partly Cloudy</p>
                            </div>
                            <div class="text-right">
                                <p class="text-sm">Sunset: 7:58 PM</p>
                                <p class="text-sm">Perfect beach weather!</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-3 mb-6">
                    <button onclick="showPage('rsvp')" class="wedding-card p-4 text-center hover:scale-105 transition">
                        <i class="fas fa-envelope text-2xl text-emerald-600 mb-2"></i>
                        <p class="text-sm font-semibold">RSVP</p>
                    </button>
                    <button onclick="showPage('story')" class="wedding-card p-4 text-center hover:scale-105 transition">
                        <i class="fas fa-heart text-2xl text-pink-600 mb-2"></i>
                        <p class="text-sm font-semibold">Our Story</p>
                    </button>
                    <button onclick="showPage('party')" class="wedding-card p-4 text-center hover:scale-105 transition">
                        <i class="fas fa-users text-2xl text-purple-600 mb-2"></i>
                        <p class="text-sm font-semibold">Wedding Party</p>
                    </button>
                    <button onclick="showPage('music')" class="wedding-card p-4 text-center hover:scale-105 transition">
                        <i class="fas fa-music text-2xl text-blue-600 mb-2"></i>
                        <p class="text-sm font-semibold">Song Requests</p>
                    </button>
                </div>

                <!-- Event Feed -->
                <h3 class="text-xl font-bold mb-4 flex items-center">
                    <i class="fas fa-stream mr-2 text-emerald-600"></i>
                    Live Event Feed
                </h3>
                <div id="feed-posts" class="space-y-4">
                    <div class="skeleton h-32 rounded-lg"></div>
                    <div class="skeleton h-32 rounded-lg"></div>
                </div>
            </div>

            <!-- Enhanced Schedule Page -->
            <div id="page-schedule" class="page">
                <h2 class="text-3xl font-bold text-center mb-6 font-display">
                    <i class="fas fa-calendar-heart text-pink-600 mr-2"></i>
                    Wedding Weekend Schedule
                </h2>
                <div id="schedule-tabs" class="flex justify-center mb-6 space-x-2">
                    <button onclick="filterSchedule('all', this)" class="schedule-tab px-4 py-2 rounded-lg bg-emerald-600 text-white transition">
                        All Events
                    </button>
                    <button onclick="filterSchedule('wedding', this)" class="schedule-tab px-4 py-2 rounded-lg bg-stone-200 text-stone-700 hover:bg-stone-300 transition">
                        Wedding Only
                    </button>
                    <button onclick="filterSchedule('reunion', this)" class="schedule-tab px-4 py-2 rounded-lg bg-stone-200 text-stone-700 hover:bg-stone-300 transition">
                        Reunion Only
                    </button>
                </div>
                <div id="schedule-list" class="space-y-4"></div>
            </div>
            
            <!-- Enhanced Games Page -->
            <div id="page-games" class="page">
                <h2 class="text-3xl font-bold text-center mb-6 font-display">
                    <i class="fas fa-gamepad text-purple-600 mr-2"></i>
                    Games & Challenges
                </h2>
                
                <!-- Achievement Progress -->
                <div class="wedding-card mb-6">
                    <h3 class="text-lg font-bold mb-3">Your Achievements</h3>
                    <div class="grid grid-cols-3 md:grid-cols-6 gap-3" id="achievements-grid">
                        <!-- Achievements will be populated here -->
                    </div>
                </div>
                
                <div class="grid md:grid-cols-2 gap-6 max-w-4xl mx-auto">
                    <div class="game-card wedding-card" onclick="openModal('trivia-modal')">
                        <div class="text-center">
                            <i class="fas fa-brain text-4xl text-emerald-600 mb-3"></i>
                            <h3 class="text-2xl font-bold text-emerald-700 mb-2">Couple's Trivia</h3>
                            <p class="text-stone-600">Test your knowledge about Jaycee & Emily!</p>
                            <div class="mt-3">
                                <span class="text-xs bg-emerald-100 text-emerald-700 px-2 py-1 rounded-full">
                                    <i class="fas fa-trophy"></i> 50 points
                                </span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="game-card wedding-card" onclick="openModal('bingo-modal')">
                        <div class="text-center">
                            <i class="fas fa-th text-4xl text-pink-600 mb-3"></i>
                            <h3 class="text-2xl font-bold text-pink-700 mb-2">Wedding Bingo</h3>
                            <p class="text-stone-600">Meet people & complete challenges!</p>
                            <div class="mt-3">
                                <span class="text-xs bg-pink-100 text-pink-700 px-2 py-1 rounded-full">
                                    <i class="fas fa-trophy"></i> 100 points
                                </span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="game-card wedding-card" onclick="openModal('scavenger-modal')">
                        <div class="text-center">
                            <i class="fas fa-map-marked-alt text-4xl text-blue-600 mb-3"></i>
                            <h3 class="text-2xl font-bold text-blue-700 mb-2">Beach Hunt</h3>
                            <p class="text-stone-600">Explore Myrtle Beach locations!</p>
                            <div class="mt-3">
                                <span class="text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded-full">
                                    <i class="fas fa-trophy"></i> 150 points
                                </span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="game-card wedding-card" onclick="openModal('predictions-modal')">
                        <div class="text-center">
                            <i class="fas fa-crystal-ball text-4xl text-purple-600 mb-3"></i>
                            <h3 class="text-2xl font-bold text-purple-700 mb-2">Future Predictions</h3>
                            <p class="text-stone-600">Predict the couple's future!</p>
                            <div class="mt-3">
                                <span class="text-xs bg-purple-100 text-purple-700 px-2 py-1 rounded-full">
                                    <i class="fas fa-trophy"></i> 30 points
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Leaderboard -->
                <div class="mt-8 wedding-card">
                    <h3 class="text-xl font-bold mb-4 flex items-center">
                        <i class="fas fa-trophy text-yellow-500 mr-2"></i>
                        Top Players
                    </h3>
                    <div id="leaderboard" class="space-y-2"></div>
                </div>
            </div>

            <!-- Enhanced Photo Gallery -->
            <div id="page-photos" class="page">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-3xl font-bold font-display">
                        <i class="fas fa-camera text-pink-600 mr-2"></i>
                        Photo Memories
                    </h2>
                    <div class="flex space-x-2">
                        <button onclick="openModal('photo-booth-modal')" class="btn-primary text-sm">
                            <i class="fas fa-camera-retro mr-2"></i>
                            Photo Booth
                        </button>
                        <button id="generate-highlight-button" class="gemini-button font-semibold py-2 px-4 rounded-lg text-sm flex items-center">
                            <span class="mr-2">✨</span> AI Highlights
                        </button>
                    </div>
                </div>
                
                <!-- Photo Filters -->
                <div class="flex gap-2 mb-4 overflow-x-auto pb-2">
                    <button onclick="filterPhotos('all')" class="px-4 py-2 rounded-full bg-emerald-600 text-white text-sm whitespace-nowrap">
                        All Photos
                    </button>
                    <button onclick="filterPhotos('ceremony')" class="px-4 py-2 rounded-full bg-stone-200 text-stone-700 text-sm whitespace-nowrap">
                        Ceremony
                    </button>
                    <button onclick="filterPhotos('reception')" class="px-4 py-2 rounded-full bg-stone-200 text-stone-700 text-sm whitespace-nowrap">
                        Reception
                    </button>
                    <button onclick="filterPhotos('candid')" class="px-4 py-2 rounded-full bg-stone-200 text-stone-700 text-sm whitespace-nowrap">
                        Candids
                    </button>
                </div>
                
                <div id="photo-grid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"></div>
            </div>
            
            <!-- Enhanced Guestbook -->
            <div id="page-guestbook" class="page">
                <h2 class="text-3xl font-bold text-center mb-6 font-display">
                    <i class="fas fa-book-heart text-pink-600 mr-2"></i>
                    Digital Guestbook
                </h2>
                <p class="text-center text-stone-600 dark:text-stone-400 mb-8 max-w-2xl mx-auto">
                    Leave a heartfelt message, record a video toast, or share your favorite memory!
                </p>
                
                <!-- Message Type Tabs -->
                <div class="flex justify-center mb-6 space-x-2">
                    <button onclick="filterGuestbook('all')" class="px-4 py-2 rounded-lg bg-emerald-600 text-white">
                        All Messages
                    </button>
                    <button onclick="filterGuestbook('text')" class="px-4 py-2 rounded-lg bg-stone-200 text-stone-700">
                        Written
                    </button>
                    <button onclick="filterGuestbook('audio')" class="px-4 py-2 rounded-lg bg-stone-200 text-stone-700">
                        Audio
                    </button>
                    <button onclick="filterGuestbook('video')" class="px-4 py-2 rounded-lg bg-stone-200 text-stone-700">
                        Video
                    </button>
                </div>
                
                <div id="guestbook-messages" class="space-y-4"></div>
            </div>

            <!-- Enhanced Guide -->
            <div id="page-guide" class="page">
                <h2 class="text-3xl font-bold text-center mb-4 font-display">
                    <i class="fas fa-map-pin text-blue-600 mr-2"></i>
                    Myrtle Beach Guide
                </h2>
                <p class="text-center text-stone-600 dark:text-stone-400 mb-6">
                    Our favorite spots and must-visit places in Myrtle Beach!
                </p>
                <div class="flex flex-wrap justify-center gap-2 mb-6">
                    <button onclick="filterGuide('all', this)" class="guide-filter px-4 py-2 rounded-lg bg-emerald-600 text-white text-sm">
                        All Places
                    </button>
                    <button onclick="filterGuide('favorites', this)" class="guide-filter px-4 py-2 rounded-lg bg-stone-200 text-stone-700 text-sm">
                        ❤️ Our Favorites
                    </button>
                    <button onclick="filterGuide('dining', this)" class="guide-filter px-4 py-2 rounded-lg bg-stone-200 text-stone-700 text-sm">
                        🍽️ Dining
                    </button>
                    <button onclick="filterGuide('activities', this)" class="guide-filter px-4 py-2 rounded-lg bg-stone-200 text-stone-700 text-sm">
                        🎢 Activities
                    </button>
                    <button onclick="filterGuide('romantic', this)" class="guide-filter px-4 py-2 rounded-lg bg-stone-200 text-stone-700 text-sm">
                        💕 Romantic
                    </button>
                </div>
                <div id="guide-grid" class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6"></div>
            </div>

            <!-- Guest Directory -->
            <div id="page-guests" class="page">
                <h2 class="text-3xl font-bold text-center mb-6 font-display">
                    <i class="fas fa-users text-purple-600 mr-2"></i>
                    Guest Directory
                </h2>
                <div class="mb-6">
                    <div class="relative">
                        <input type="text" id="guest-search" placeholder="Search guests by name or table..." 
                               class="rsvp-input pl-10">
                        <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-stone-400"></i>
                    </div>
                </div>
                <div id="guest-list" class="grid md:grid-cols-2 lg:grid-cols-3 gap-4"></div>
            </div>

            <!-- NEW: RSVP Page -->
            <div id="page-rsvp" class="page">
                <h2 class="text-3xl font-bold text-center mb-6 font-display">
                    <i class="fas fa-envelope-open-heart text-pink-600 mr-2"></i>
                    RSVP & Details
                </h2>
                <div class="max-w-2xl mx-auto">
                    <div class="wedding-card">
                        <h3 class="text-xl font-bold mb-4">Your RSVP Status</h3>
                        <div id="rsvp-status" class="mb-6">
                            <!-- RSVP status will be shown here -->
                        </div>
                        <form id="rsvp-form" class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium mb-2">Will you attend?</label>
                                <div class="grid grid-cols-2 gap-3">
                                    <button type="button" onclick="setAttending(true)" class="rsvp-option p-4 border-2 rounded-lg text-center hover:border-emerald-500 transition">
                                        <i class="fas fa-check-circle text-2xl text-emerald-600 mb-2"></i>
                                        <p>Yes, I'll be there!</p>
                                    </button>
                                    <button type="button" onclick="setAttending(false)" class="rsvp-option p-4 border-2 rounded-lg text-center hover:border-red-500 transition">
                                        <i class="fas fa-times-circle text-2xl text-red-600 mb-2"></i>
                                        <p>Sorry, can't make it</p>
                                    </button>
                                </div>
                            </div>
                            <div id="rsvp-details" class="hidden space-y-4">
                                <div>
                                    <label class="block text-sm font-medium mb-2">Number of guests (including you)</label>
                                    <input type="number" id="guest-count" min="1" max="5" value="1" class="rsvp-input">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-2">Dietary restrictions</label>
                                    <textarea id="dietary-restrictions" rows="3" placeholder="Vegetarian, allergies, etc." class="rsvp-input"></textarea>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-2">Song requests for the reception</label>
                                    <input type="text" id="song-request" placeholder="What gets you on the dance floor?" class="rsvp-input">
                                </div>
                            </div>
                            <button type="submit" class="btn-primary w-full">
                                Update RSVP
                            </button>
                        </form>
                    </div>
                    
                    <!-- Table Assignment -->
                    <div class="wedding-card mt-6">
                        <h3 class="text-xl font-bold mb-4">Your Table Assignment</h3>
                        <div id="table-assignment" class="text-center py-8">
                            <i class="fas fa-chair text-4xl text-stone-400 mb-3"></i>
                            <p class="text-stone-600">Table assignments will be available closer to the wedding date</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- NEW: Love Story Timeline -->
            <div id="page-story" class="page">
                <h2 class="text-3xl font-bold text-center mb-6 font-display">
                    <i class="fas fa-heart text-pink-600 mr-2"></i>
                    Our Love Story
                </h2>
                <div class="max-w-3xl mx-auto">
                    <div class="timeline-container">
                        <div class="timeline-item">
                            <div class="wedding-card">
                                <h3 class="text-xl font-bold mb-2">First Meeting</h3>
                                <p class="text-sm text-stone-600 mb-2">September 15, 2019</p>
                                <p>We met at a mutual friend's beach bonfire. Emily was trying to roast a marshmallow and set it on fire. Jaycee heroically saved the s'more (and maybe stole Emily's heart).</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="wedding-card">
                                <h3 class="text-xl font-bold mb-2">First Date</h3>
                                <p class="text-sm text-stone-600 mb-2">October 3, 2019</p>
                                <p>Mini golf at Captain Hook's. Jaycee let Emily win (or so he claims). We ended the night sharing funnel cake on the boardwalk.</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="wedding-card">
                                <h3 class="text-xl font-bold mb-2">The Proposal</h3>
                                <p class="text-sm text-stone-600 mb-2">June 12, 2024</p>
                                <p>On the same beach where we first met, during sunset, Jaycee got down on one knee. Emily said yes before he could even finish asking!</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="wedding-card">
                                <h3 class="text-xl font-bold mb-2">Wedding Day</h3>
                                <p class="text-sm text-stone-600 mb-2">July 27, 2025</p>
                                <p>The best day of our lives, celebrating with all of you! 💕</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- NEW: Wedding Party -->
            <div id="page-party" class="page">
                <h2 class="text-3xl font-bold text-center mb-6 font-display">
                    <i class="fas fa-user-friends text-purple-600 mr-2"></i>
                    Meet the Wedding Party
                </h2>
                <div class="grid md:grid-cols-2 gap-8 max-w-4xl mx-auto">
                    <div>
                        <h3 class="text-2xl font-bold text-center mb-4 text-pink-600">Bride's Side</h3>
                        <div class="space-y-4">
                            <div class="wedding-card flex items-center">
                                <div class="w-20 h-20 rounded-full bg-pink-100 flex items-center justify-center mr-4">
                                    <i class="fas fa-crown text-2xl text-pink-600"></i>
                                </div>
                                <div>
                                    <h4 class="font-bold">Sarah Johnson</h4>
                                    <p class="text-sm text-stone-600">Maid of Honor</p>
                                    <p class="text-xs mt-1">Emily's sister and partner in crime since birth</p>
                                </div>
                            </div>
                            <div class="wedding-card flex items-center">
                                <div class="w-20 h-20 rounded-full bg-pink-100 flex items-center justify-center mr-4">
                                    <i class="fas fa-user text-2xl text-pink-600"></i>
                                </div>
                                <div>
                                    <h4 class="font-bold">Ashley Martinez</h4>
                                    <p class="text-sm text-stone-600">Bridesmaid</p>
                                    <p class="text-xs mt-1">College roommate and karaoke partner</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div>
                        <h3 class="text-2xl font-bold text-center mb-4 text-emerald-600">Groom's Side</h3>
                        <div class="space-y-4">
                            <div class="wedding-card flex items-center">
                                <div class="w-20 h-20 rounded-full bg-emerald-100 flex items-center justify-center mr-4">
                                    <i class="fas fa-crown text-2xl text-emerald-600"></i>
                                </div>
                                <div>
                                    <h4 class="font-bold">Michael Williams</h4>
                                    <p class="text-sm text-stone-600">Best Man</p>
                                    <p class="text-xs mt-1">Jaycee's brother and golf buddy</p>
                                </div>
                            </div>
                            <div class="wedding-card flex items-center">
                                <div class="w-20 h-20 rounded-full bg-emerald-100 flex items-center justify-center mr-4">
                                    <i class="fas fa-user text-2xl text-emerald-600"></i>
                                </div>
                                <div>
                                    <h4 class="font-bold">David Chen</h4>
                                    <p class="text-sm text-stone-600">Groomsman</p>
                                    <p class="text-xs mt-1">High school friend and fantasy football rival</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- NEW: Music Requests -->
            <div id="page-music" class="page">
                <h2 class="text-3xl font-bold text-center mb-6 font-display">
                    <i class="fas fa-music text-blue-600 mr-2"></i>
                    Reception Playlist
                </h2>
                <p class="text-center text-stone-600 mb-6">Help us create the perfect dance floor playlist!</p>
                
                <div class="max-w-2xl mx-auto">
                    <!-- Add Song Request -->
                    <div class="wedding-card mb-6">
                        <h3 class="text-lg font-bold mb-3">Request a Song</h3>
                        <div class="flex gap-2">
                            <input type="text" id="song-input" placeholder="Song title - Artist" class="rsvp-input flex-1">
                            <button onclick="requestSong()" class="btn-primary">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Top Requested Songs -->
                    <div class="wedding-card">
                        <h3 class="text-lg font-bold mb-4">Top Requested Songs</h3>
                        <div id="song-list" class="space-y-3">
                            <!-- Songs will be populated here -->
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Enhanced Floating Action Buttons -->
        <div id="fab-container" class="fixed bottom-28 right-5 z-20 flex flex-col space-y-3"></div>

        <!-- Enhanced Navigation -->
        <nav class="fixed bottom-0 left-0 right-0 glass-morphism border-t border-stone-200/50 dark:border-stone-700/50 shadow-t-sm z-30 no-print">
            <div class="container mx-auto grid grid-cols-5 text-center py-2">
                <button onclick="showPage('home')" class="nav-icon active flex flex-col items-center py-2 text-stone-600 dark:text-stone-400 hover:text-emerald-700 dark:hover:text-emerald-500 transition haptic">
                    <i class="fas fa-home text-xl mb-1"></i>
                    <span class="text-xs">Home</span>
                </button>
                <button onclick="showPage('schedule')" class="nav-icon flex flex-col items-center py-2 text-stone-600 dark:text-stone-400 hover:text-emerald-700 dark:hover:text-emerald-500 transition haptic">
                    <i class="fas fa-calendar text-xl mb-1"></i>
                    <span class="text-xs">Schedule</span>
                </button>
                <button onclick="showPage('photos')" class="nav-icon flex flex-col items-center py-2 text-stone-600 dark:text-stone-400 hover:text-emerald-700 dark:hover:text-emerald-500 transition haptic">
                    <i class="fas fa-camera text-xl mb-1"></i>
                    <span class="text-xs">Photos</span>
                </button>
                <button onclick="showPage('games')" class="nav-icon flex flex-col items-center py-2 text-stone-600 dark:text-stone-400 hover:text-emerald-700 dark:hover:text-emerald-500 transition haptic">
                    <i class="fas fa-gamepad text-xl mb-1"></i>
                    <span class="text-xs">Games</span>
                </button>
                <button onclick="toggleMoreMenu()" class="nav-icon flex flex-col items-center py-2 text-stone-600 dark:text-stone-400 hover:text-emerald-700 dark:hover:text-emerald-500 transition haptic">
                    <i class="fas fa-ellipsis-h text-xl mb-1"></i>
                    <span class="text-xs">More</span>
                </button>
            </div>
        </nav>

        <!-- More Menu Overlay -->
        <div id="more-menu" class="fixed bottom-20 right-4 glass-morphism rounded-lg shadow-xl p-2 hidden z-40 min-w-[200px]">
            <button onclick="showPage('guestbook'); toggleMoreMenu()" class="w-full text-left px-4 py-3 hover:bg-stone-100 dark:hover:bg-stone-800 rounded transition flex items-center">
                <i class="fas fa-book-heart mr-3 text-pink-600"></i> Guestbook
            </button>
            <button onclick="showPage('guide'); toggleMoreMenu()" class="w-full text-left px-4 py-3 hover:bg-stone-100 dark:hover:bg-stone-800 rounded transition flex items-center">
                <i class="fas fa-map mr-3 text-blue-600"></i> Local Guide
            </button>
            <button onclick="showPage('guests'); toggleMoreMenu()" class="w-full text-left px-4 py-3 hover:bg-stone-100 dark:hover:bg-stone-800 rounded transition flex items-center">
                <i class="fas fa-users mr-3 text-purple-600"></i> Guests
            </button>
            <button onclick="showPage('rsvp'); toggleMoreMenu()" class="w-full text-left px-4 py-3 hover:bg-stone-100 dark:hover:bg-stone-800 rounded transition flex items-center">
                <i class="fas fa-envelope mr-3 text-emerald-600"></i> RSVP
            </button>
            <button onclick="showPage('story'); toggleMoreMenu()" class="w-full text-left px-4 py-3 hover:bg-stone-100 dark:hover:bg-stone-800 rounded transition flex items-center">
                <i class="fas fa-heart mr-3 text-red-600"></i> Our Story
            </button>
            <button onclick="showPage('party'); toggleMoreMenu()" class="w-full text-left px-4 py-3 hover:bg-stone-100 dark:hover:bg-stone-800 rounded transition flex items-center">
                <i class="fas fa-user-friends mr-3 text-indigo-600"></i> Wedding Party
            </button>
            <button onclick="showPage('music'); toggleMoreMenu()" class="w-full text-left px-4 py-3 hover:bg-stone-100 dark:hover:bg-stone-800 rounded transition flex items-center">
                <i class="fas fa-music mr-3 text-cyan-600"></i> Music
            </button>
            <div class="border-t border-stone-200 dark:border-stone-700 my-2"></div>
            <a href="https://www.amazon.com/wedding/registry/1I8SUL5YPLE9V" target="_blank" class="w-full text-left px-4 py-3 hover:bg-stone-100 dark:hover:bg-stone-800 rounded transition flex items-center">
                <i class="fas fa-gift mr-3 text-yellow-600"></i> Registry
            </a>
        </div>
    </div>

    <!-- Enhanced Login Screen -->
    <div id="login-screen" class="min-h-screen flex items-center justify-center p-4 bg-gradient-to-br from-pink-50 via-white to-emerald-50">
        <div class="max-w-md w-full">
            <div class="text-center mb-8 animate-float">
                <div class="text-6xl mb-4">💕</div>
                <h1 class="text-5xl font-bold text-stone-800 mb-2 font-script">Welcome to</h1>
                <h2 class="text-4xl font-display bg-gradient-to-r from-emerald-600 to-pink-600 bg-clip-text text-transparent">
                    Jaycee & Emily's Wedding
                </h2>
            </div>
            
            <div class="wedding-card backdrop-blur-lg bg-white/90">
                <div class="text-center mb-6">
                    <p class="text-lg text-stone-600">July 27th, 2025</p>
                    <p class="text-stone-600">Myrtle Beach, South Carolina</p>
                </div>
                
                <div class="space-y-4">
                    <input id="display-name-input" type="text" placeholder="Enter your full name" 
                           class="rsvp-input text-center text-lg">
                    <select id="relationship-select" class="rsvp-input text-center">
                        <option value="">How do you know the couple?</option>
                        <option value="Groom's Family">Groom's Family</option>
                        <option value="Bride's Family">Bride's Family</option>
                        <option value="Groom's Friend">Groom's Friend</option>
                        <option value="Bride's Friend">Bride's Friend</option>
                        <option value="Wedding Party">Wedding Party</option>
                        <option value="Work Colleague">Work Colleague</option>
                        <option value="Other">Other</option>
                    </select>
                    <button id="join-button" class="btn-primary w-full text-lg">
                        Join the Celebration! 🎉
                    </button>
                </div>
            </div>
            
            <p class="text-center text-sm text-stone-500 mt-6">
                By joining, you agree to share the love and joy of this special day
            </p>
        </div>
    </div>
    
    <!-- Enhanced Modals -->
    <!-- Post Modal -->
    <div id="post-modal" class="modal-backdrop fixed inset-0 bg-black bg-opacity-50 z-40 flex items-center justify-center p-4 opacity-0 pointer-events-none">
        <div class="modal-content bg-white dark:bg-stone-800 rounded-lg shadow-xl w-full max-w-md transform scale-95">
            <div class="p-6">
                <h3 class="text-2xl font-bold mb-4">Share a Moment 💭</h3>
                <textarea id="post-text-input" placeholder="Share a memory, well-wish, or update..." 
                          class="rsvp-input h-24"></textarea>
                <div class="flex justify-between items-center mt-4">
                    <button id="suggest-post-button" class="gemini-button font-semibold py-2 px-3 rounded-lg text-sm flex items-center">
                        <span class="mr-2">✨</span> AI Suggest
                    </button>
                    <div class="flex space-x-3">
                        <button onclick="closeModal('post-modal')" class="px-4 py-2 rounded-lg border border-stone-300 text-stone-700 hover:bg-stone-100">
                            Cancel
                        </button>
                        <button id="submit-post-button" class="btn-primary">
                            Post
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Photo Modal -->
    <div id="photo-modal" class="modal-backdrop fixed inset-0 bg-black bg-opacity-50 z-40 flex items-center justify-center p-4 opacity-0 pointer-events-none">
        <div class="modal-content bg-white dark:bg-stone-800 rounded-lg shadow-xl w-full max-w-md transform scale-95">
            <div class="p-6">
                <h3 class="text-2xl font-bold mb-4">Add a Photo 📸</h3>
                <div class="space-y-4">
                    <input type="file" id="photo-file-input" class="hidden" accept="image/*">
                    <label for="photo-file-input" class="block w-full text-center p-8 border-2 border-dashed border-emerald-300 rounded-lg hover:border-emerald-500 cursor-pointer transition bg-emerald-50 dark:bg-emerald-900/20">
                        <i class="fas fa-cloud-upload-alt text-4xl text-emerald-600 mb-2"></i>
                        <span id="file-chosen-text" class="block text-stone-600 dark:text-stone-400">
                            Click to choose a photo
                        </span>
                    </label>
                    <select id="photo-category" class="rsvp-input">
                        <option value="candid">Candid Moment</option>
                        <option value="ceremony">Ceremony</option>
                        <option value="reception">Reception</option>
                        <option value="group">Group Photo</option>
                    </select>
                    <textarea id="photo-caption-input" placeholder="Add a caption..." 
                              class="rsvp-input h-20"></textarea>
                </div>
                <div id="upload-progress-container" class="w-full bg-gray-200 rounded-full h-2.5 mt-4 hidden overflow-hidden">
                    <div id="upload-progress-bar" class="bg-gradient-to-r from-emerald-500 to-emerald-600 h-2.5 rounded-full transition-all duration-300" 
                         style="width: 0%"></div>
                </div>
                <div class="flex justify-end space-x-3 mt-4">
                    <button onclick="closeModal('photo-modal')" class="px-4 py-2 rounded-lg border border-stone-300 text-stone-700 hover:bg-stone-100">
                        Cancel
                    </button>
                    <button id="submit-photo-button" class="btn-primary" disabled>
                        Upload Photo
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Photo Booth Modal -->
    <div id="photo-booth-modal" class="modal-backdrop fixed inset-0 bg-black bg-opacity-50 z-40 flex items-center justify-center p-4 opacity-0 pointer-events-none">
        <div class="modal-content bg-white dark:bg-stone-800 rounded-lg shadow-xl w-full max-w-2xl transform scale-95">
            <div class="p-6">
                <h3 class="text-2xl font-bold mb-4">Photo Booth 📸</h3>
                <div class="relative">
                    <video id="photo-booth-video" class="w-full rounded-lg mb-4" autoplay></video>
                    <canvas id="photo-booth-canvas" class="hidden"></canvas>
                    <div id="photo-booth-preview" class="hidden w-full rounded-lg mb-4"></div>
                </div>
                
                <!-- Filters -->
                <div class="flex gap-2 mb-4 overflow-x-auto pb-2">
                    <div class="filter-option active" onclick="setPhotoFilter('none')">
                        <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='80' height='80'%3E%3Crect width='80' height='80' fill='%23f3f4f6'/%3E%3Ctext x='50%25' y='50%25' text-anchor='middle' dy='.3em' font-family='sans-serif' font-size='12' fill='%23374151'%3ENone%3C/text%3E%3C/svg%3E" alt="None">
                    </div>
                    <div class="filter-option" onclick="setPhotoFilter('wedding')">
                        <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='80' height='80'%3E%3Crect width='80' height='80' fill='%23fce7f3'/%3E%3Ctext x='50%25' y='50%25' text-anchor='middle' dy='.3em' font-family='sans-serif' font-size='12' fill='%23be185d'%3EWedding%3C/text%3E%3C/svg%3E" alt="Wedding">
                    </div>
                    <div class="filter-option" onclick="setPhotoFilter('beach')">
                        <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='80' height='80'%3E%3Crect width='80' height='80' fill='%23dbeafe'/%3E%3Ctext x='50%25' y='50%25' text-anchor='middle' dy='.3em' font-family='sans-serif' font-size='12' fill='%231e40af'%3EBeach%3C/text%3E%3C/svg%3E" alt="Beach">
                    </div>
                </div>
                
                <div class="flex justify-between">
                    <button onclick="closeModal('photo-booth-modal')" class="px-4 py-2 rounded-lg border border-stone-300 text-stone-700 hover:bg-stone-100">
                        Close
                    </button>
                    <div class="space-x-3">
                        <button id="capture-photo-btn" onclick="capturePhoto()" class="btn-primary">
                            <i class="fas fa-camera mr-2"></i> Capture
                        </button>
                        <button id="save-photo-btn" onclick="saveBoothPhoto()" class="btn-primary hidden">
                            <i class="fas fa-save mr-2"></i> Save & Share
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Enhanced Guestbook Modal -->
    <div id="guestbook-input-modal" class="modal-backdrop fixed inset-0 bg-black bg-opacity-50 z-40 flex items-center justify-center p-4 opacity-0 pointer-events-none">
        <div class="modal-content bg-white dark:bg-stone-800 rounded-lg shadow-xl w-full max-w-md transform scale-95">
            <div class="p-6">
                <h3 class="text-2xl font-bold mb-4">Leave a Message 💌</h3>
                
                <!-- Text Message Form -->
                <div id="text-message-form" class="message-form">
                    <textarea id="guestbook-text-input" placeholder="Write your heartfelt message for Jaycee & Emily..." 
                              class="rsvp-input h-32 mb-4"></textarea>
                    <div class="flex justify-between items-center">
                        <button id="suggest-message-button" class="gemini-button font-semibold py-2 px-3 rounded-lg text-sm flex items-center">
                            <span class="mr-2">✨</span> AI Suggest
                        </button>
                        <div class="flex space-x-3">
                            <button onclick="closeModal('guestbook-input-modal')" class="px-4 py-2 rounded-lg border border-stone-300 text-stone-700 hover:bg-stone-100">
                                Cancel
                            </button>
                            <button id="submit-text-message" class="btn-primary">
                                Submit
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Audio Message Form -->
                <div id="audio-message-form" class="message-form hidden">
                    <div class="text-center py-8">
                        <p class="text-stone-600 mb-4">Press and hold to record your message</p>
                        <button id="record-audio-button" class="bg-red-500 text-white rounded-full p-6 shadow-lg hover:bg-red-600 transition duration-300">
                            <i class="fas fa-microphone text-3xl"></i>
                        </button>
                        <p id="record-status" class="text-sm text-stone-500 mt-3 h-5"></p>
                        <div id="audio-waveform" class="mt-4 h-16 hidden">
                            <!-- Audio visualization would go here -->
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 mt-4">
                        <button onclick="closeModal('guestbook-input-modal')" class="px-4 py-2 rounded-lg border border-stone-300 text-stone-700 hover:bg-stone-100">
                            Cancel
                        </button>
                    </div>
                </div>
                
                <!-- Video Message Form -->
                <div id="video-message-form" class="message-form hidden">
                    <div class="text-center">
                        <video id="video-preview" class="w-full rounded-lg mb-4 hidden" autoplay muted></video>
                        <button id="record-video-button" class="bg-red-500 text-white rounded-full p-6 shadow-lg hover:bg-red-600 transition">
                            <i class="fas fa-video text-3xl"></i>
                        </button>
                        <p id="video-status" class="text-sm text-stone-500 mt-3"></p>
                    </div>
                    <div class="flex justify-end space-x-3 mt-4">
                        <button onclick="closeModal('guestbook-input-modal')" class="px-4 py-2 rounded-lg border border-stone-300 text-stone-700 hover:bg-stone-100">
                            Cancel
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Enhanced Game Modals -->
    <!-- Trivia Modal -->
    <div id="trivia-modal" class="modal-backdrop fixed inset-0 bg-black bg-opacity-50 z-40 flex items-center justify-center p-4 opacity-0 pointer-events-none">
        <div id="trivia-content" class="modal-content bg-white dark:bg-stone-800 rounded-lg shadow-xl w-full max-w-lg transform scale-95 p-6">
            <!-- Trivia content will be populated here -->
        </div>
    </div>

    <!-- Other modals remain similar but with enhanced styling -->
    
    <!-- Photo Lightbox -->
    <div id="photo-lightbox" class="fixed inset-0 bg-black bg-opacity-95 z-50 hidden flex items-center justify-center p-4">
        <button onclick="closeLightbox()" class="absolute top-4 right-4 text-white text-3xl hover:text-stone-300">
            <i class="fas fa-times"></i>
        </button>
        <button onclick="previousPhoto()" class="absolute left-4 text-white text-3xl hover:text-stone-300">
            <i class="fas fa-chevron-left"></i>
        </button>
        <button onclick="nextPhoto()" class="absolute right-4 text-white text-3xl hover:text-stone-300">
            <i class="fas fa-chevron-right"></i>
        </button>
        <div class="max-w-5xl max-h-[90vh]">
            <img id="lightbox-image" src="" alt="" class="max-w-full max-h-full rounded-lg">
            <div class="text-white text-center mt-4">
                <p id="lightbox-caption" class="text-lg"></p>
                <p id="lightbox-author" class="text-sm text-stone-400"></p>
            </div>
        </div>
    </div>

    <!-- Enhanced Script Section -->
    <script type="module">
        // Import Firebase modules
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, setDoc, addDoc, collection, query, onSnapshot, serverTimestamp, getDocs, updateDoc, where, orderBy, limit, increment } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { getStorage, ref, uploadBytesResumable, getDownloadURL } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-storage.js";

        // --- GLOBAL VARIABLES ---
        let app, auth, db, storage;
        let currentUser = null;
        let currentUnsubscribes = [];
        let mediaRecorder;
        let audioChunks = [];
        let currentPhotoFilter = 'none';
        let photoBoothStream = null;
        let lightboxPhotos = [];
        let currentLightboxIndex = 0;

// For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyDe-yqRr9nKvh4azzYPMRP8cvBUs7k2mfg",
  authDomain: "williams-wedding-hub.firebaseapp.com",
  projectId: "williams-wedding-hub",
  storageBucket: "williams-wedding-hub.firebasestorage.app",
  messagingSenderId: "554261439707",
  appId: "1:554261439707:web:a9c9aee62db3cff7a6d8fe",
  measurementId: "G-K6H5J1ZLNE"
};
        
        const geminiApiKey = "AIzaSyCV3bEJGDZOg2LHdfDusA_pdHm9dcxavpk";
        const appId = 'williams-wedding-2025';
        const USER_STORAGE_KEY = `weddingHubUser_${appId}`;

        // Achievement definitions
        const achievements = [
            { id: 'first_post', name: 'First Share', icon: '📝', points: 10, description: 'Share your first post' },
            { id: 'photographer', name: 'Photographer', icon: '📸', points: 20, description: 'Upload 5 photos' },
            { id: 'social_butterfly', name: 'Social Butterfly', icon: '🦋', points: 30, description: 'Complete wedding bingo' },
            { id: 'love_prophet', name: 'Love Prophet', icon: '🔮', points: 25, description: 'Make predictions' },
            { id: 'memory_keeper', name: 'Memory Keeper', icon: '💭', points: 15, description: 'Leave a guestbook message' },
            { id: 'trivia_master', name: 'Trivia Master', icon: '🧠', points: 50, description: 'Perfect trivia score' }
        ];

        // --- INITIALIZATION ---
        async function initialize() {
            app = initializeApp(firebaseConfig);
            auth = getAuth(app);
            db = getFirestore(app);
            storage = getStorage(app);

            onAuthStateChanged(auth, async (user) => {
                if (user) {
                    const userDocRef = doc(db, `artifacts/${appId}/public/data/users/${user.uid}`);
                    const userDoc = await getDoc(userDocRef);
                    if (userDoc.exists()) {
                        currentUser = { uid: user.uid, ...userDoc.data() };
                        localStorage.setItem(USER_STORAGE_KEY, JSON.stringify(currentUser));
                        showApp();
                    } else {
                        loginScreen.classList.remove('hidden');
                        appContainer.classList.add('hidden');
                    }
                } else {
                    loginScreen.classList.remove('hidden');
                    appContainer.classList.add('hidden');
                }
            });
        }

        // --- AUTHENTICATION ---
        const loginScreen = document.getElementById('login-screen');
        const appContainer = document.getElementById('app-container');
        const joinButton = document.getElementById('join-button');
        const displayNameInput = document.getElementById('display-name-input');
        const relationshipSelect = document.getElementById('relationship-select');

        joinButton.addEventListener('click', async () => {
            const displayName = displayNameInput.value.trim();
            const relationship = relationshipSelect.value;
            
            if (!displayName || !relationship) {
                showToast("Please fill in all fields", "error");
                return;
            }
            
            try {
                joinButton.disabled = true;
                joinButton.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> Joining...';
                
                const userCredential = await signInAnonymously(auth);
                const user = userCredential.user;
                
                const userDocRef = doc(db, `artifacts/${appId}/public/data/users/${user.uid}`);
                await setDoc(userDocRef, {
                    displayName: displayName,
                    relationship: relationship,
                    createdAt: serverTimestamp(),
                    points: 0,
                    achievements: [],
                    photoCount: 0,
                    postCount: 0
                });
                
                celebrateJoin();
            } catch (error) {
                console.error("Error joining event: ", error);
                showToast("Could not join. Please try again.", "error");
                joinButton.disabled = false;
                joinButton.innerHTML = 'Join the Celebration! 🎉';
            }
        });

        // --- UI & NAVIGATION ---
        function showApp() {
            loginScreen.classList.add('hidden');
            appContainer.classList.remove('hidden');
            document.getElementById('user-display-name').textContent = currentUser.displayName;
            document.getElementById('user-id-display').textContent = currentUser.uid.slice(-6);
            updatePointsDisplay();
            startCountdown();
            showPage('home');
            loadGuestList();
            checkAchievements();
        }

        function updatePointsDisplay() {
            const pointsEl = document.getElementById('user-points');
            if (currentUser.points > 0) {
                pointsEl.classList.remove('hidden');
                pointsEl.querySelector('span:last-child').textContent = `${currentUser.points} pts`;
            }
        }

        window.showPage = (pageId) => {
            // Cleanup previous page listeners
            currentUnsubscribes.forEach(unsub => unsub());
            currentUnsubscribes = [];

            // Hide more menu if open
            document.getElementById('more-menu').classList.add('hidden');

            // Switch active page with animation
            document.querySelectorAll('.page').forEach(p => {
                p.classList.remove('active');
                p.style.animation = 'none';
            });
            const newPage = document.getElementById(`page-${pageId}`);
            newPage.classList.add('active');
            newPage.style.animation = 'slide-up 0.5s ease-out';
            
            // Update navigation
            document.querySelectorAll('.nav-icon').forEach(icon => {
                icon.classList.remove('active');
            });
            
            // Update FAB
            updateFab(pageId);
            
            // Load page-specific data
            switch(pageId) {
                case 'home': loadFeed(); break;
                case 'schedule': loadSchedule(); break;
                case 'photos': loadPhotos(); break;
                case 'games': loadGames(); break;
                case 'guestbook': loadGuestbook(); break;
                case 'guide': loadGuide('all'); break;
                case 'guests': renderGuestList(); break;
                case 'rsvp': loadRSVP(); break;
                case 'story': break; // Static content
                case 'party': break; // Static content
                case 'music': loadMusicRequests(); break;
            }
            
            // Scroll to top
            window.scrollTo(0, 0);
        }

        function updateFab(pageId) {
            const fabContainer = document.getElementById('fab-container');
            let fabHTML = '';
            
            switch(pageId) {
                case 'home':
                    fabHTML = `
                        <button onclick="openModal('post-modal')" class="btn-primary rounded-full p-4 shadow-lg">
                            <i class="fas fa-plus text-xl"></i>
                        </button>
                    `;
                    break;
                case 'photos':
                    fabHTML = `
                        <button onclick="openModal('photo-modal')" class="btn-primary rounded-full p-4 shadow-lg">
                            <i class="fas fa-camera text-xl"></i>
                        </button>
                    `;
                    break;
                case 'guestbook':
                    fabHTML = `
                        <div class="flex flex-col space-y-3">
                            <button onclick="openGuestbookModal('video')" class="btn-primary rounded-full p-3 shadow-lg">
                                <i class="fas fa-video text-lg"></i>
                            </button>
                            <button onclick="openGuestbookModal('audio')" class="btn-primary rounded-full p-3 shadow-lg">
                                <i class="fas fa-microphone text-lg"></i>
                            </button>
                            <button onclick="openGuestbookModal('text')" class="btn-primary rounded-full p-4 shadow-lg">
                                <i class="fas fa-pen text-xl"></i>
                            </button>
                        </div>
                    `;
                    break;
            }
            
            fabContainer.innerHTML = fabHTML;
        }

        // --- UTILITIES ---
        window.showToast = (message, type = 'success') => {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast show ${type === 'error' ? 'bg-red-600' : 'bg-green-600'}`;
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        window.celebrateJoin = () => {
            // Create confetti
            const colors = ['#ec4899', '#10b981', '#f59e0b', '#3b82f6', '#8b5cf6'];
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + '%';
                    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.animationDuration = (Math.random() * 3 + 2) + 's';
                    confetti.style.animationDelay = Math.random() * 0.5 + 's';
                    document.getElementById('confetti-container').appendChild(confetti);
                    setTimeout(() => confetti.remove(), 5000);
                }, i * 50);
            }
        }

        async function updateUserPoints(points, achievementId = null) {
            if (!currentUser) return;
            
            const userRef = doc(db, `artifacts/${appId}/public/data/users/${currentUser.uid}`);
            const updates = { points: increment(points) };
            
            if (achievementId && !currentUser.achievements?.includes(achievementId)) {
                const userDoc = await getDoc(userRef);
                const currentAchievements = userDoc.data()?.achievements || [];
                currentAchievements.push(achievementId);
                updates.achievements = currentAchievements;
                
                // Show achievement notification
                const achievement = achievements.find(a => a.id === achievementId);
                if (achievement) {
                    showToast(`🎉 Achievement Unlocked: ${achievement.name}! +${achievement.points}pts`);
                }
            }
            
            await updateDoc(userRef, updates);
            currentUser.points = (currentUser.points || 0) + points;
            updatePointsDisplay();
        }

        async function checkAchievements() {
            if (!currentUser) return;
            
            const userRef = doc(db, `artifacts/${appId}/public/data/users/${currentUser.uid}`);
            const userDoc = await getDoc(userRef);
            const userData = userDoc.data();
            
            // Check various achievement conditions
            if (userData.postCount >= 1 && !userData.achievements?.includes('first_post')) {
                await updateUserPoints(10, 'first_post');
            }
            
            if (userData.photoCount >= 5 && !userData.achievements?.includes('photographer')) {
                await updateUserPoints(20, 'photographer');
            }
            
            // Update achievement display
            if (document.getElementById('achievements-grid')) {
                renderAchievements();
            }
        }

        function renderAchievements() {
            const grid = document.getElementById('achievements-grid');
            if (!grid) return;
            
            grid.innerHTML = achievements.map(achievement => {
                const earned = currentUser.achievements?.includes(achievement.id);
                return `
                    <div class="text-center ${earned ? '' : 'opacity-50'}">
                        <div class="text-3xl mb-1">${achievement.icon}</div>
                        <p class="text-xs">${achievement.name}</p>
                    </div>
                `;
            }).join('');
        }

        // --- MODAL MANAGEMENT ---
        window.openModal = (modalId) => {
            const modal = document.getElementById(modalId);
            modal.classList.remove('pointer-events-none', 'opacity-0');
            modal.querySelector('.modal-content').classList.remove('scale-95');
            
            // Specific modal setup
            switch(modalId) {
                case 'trivia-modal': startTrivia(); break;
                case 'bingo-modal': startBingo(); break;
                case 'scavenger-modal': startScavengerHunt(); break;
                case 'predictions-modal': startPredictions(); break;
                case 'photo-booth-modal': initPhotoBoooth(); break;
            }
        }

        window.closeModal = (modalId) => {
            const modal = document.getElementById(modalId);
            modal.classList.add('opacity-0');
            modal.querySelector('.modal-content').classList.add('scale-95');
            setTimeout(() => modal.classList.add('pointer-events-none'), 300);
            
            // Cleanup
            if (modalId === 'photo-booth-modal' && photoBoothStream) {
                photoBoothStream.getTracks().forEach(track => track.stop());
                photoBoothStream = null;
            }
        }

        // --- COUNTDOWN ---
        function startCountdown() {
            const weddingDate = new Date('2025-07-27T16:00:00-04:00');
            const updateCountdown = () => {
                const now = new Date();
                const diff = weddingDate - now;
                
                if (diff <= 0) {
                    document.getElementById('countdown').innerHTML = `
                        <div class="text-3xl font-bold text-emerald-700 animate-pulse">
                            🎉 The Big Day is Here! 🎉
                        </div>
                    `;
                    celebrateJoin();
                    return;
                }
                
                const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((diff % (1000 * 60)) / 1000);
                
                document.getElementById('days').textContent = days.toString().padStart(2, '0');
                document.getElementById('hours').textContent = hours.toString().padStart(2, '0');
                document.getElementById('minutes').textContent = minutes.toString().padStart(2, '0');
                document.getElementById('seconds').textContent = seconds.toString().padStart(2, '0');
            };
            
            updateCountdown();
            setInterval(updateCountdown, 1000);
        }

        // --- GEMINI API ---
        async function callGemini(prompt) {
            if (!geminiApiKey || geminiApiKey === "AIzaSyCV3bEJGDZOg2LHdfDusA_pdHm9dcxavpk") {
                showToast("AI features not configured", "error");
                return null;
            }
            
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${geminiApiKey}`;
            
            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{
                            role: "user",
                            parts: [{ text: prompt }]
                        }]
                    })
                });
                
                if (!response.ok) throw new Error(`API Error: ${response.statusText}`);
